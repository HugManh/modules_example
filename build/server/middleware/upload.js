"use strict";const multer=require("multer");const{localData}=require("../config");const DatauriParser=require("datauri/parser");const path=require("path");const _diskStorage=multer.diskStorage({destination:function(req,file,cb){cb(null,localData)},filename:function(req,file,cb){console.log(file.originalname);cb(null,file.originalname)}});const upload2Disk=multer({storage:_diskStorage}).single("file");const _memStorage=multer.memoryStorage();const upload2Mem=multer({storage:_memStorage}).single("file");const upload=process.env.NODE_ENV!=="production"?upload2Mem:upload2Disk;const parser=new DatauriParser;const dataUri=req=>{const extName=path.extname(req.file.originalname).toString();const file64=parser.format(extName,req.file.buffer);return file64};module.exports={upload,dataUri};